# FPGA-SPartan6AX309-audio-filter
FPGA课程设计修改官方案例
好耶！下面我帮你整理一份完整的 README，适合你之前做的 Spartan-6 + WM8731 音频开发项目，涵盖：

✅ 使用 Spartan-6 FPGA + WM8731 音频编解码器
✅ 配置 WM8731 为 **从模式（Slave）**，数据格式采用 **DSP Mode B**
✅ 已实现音频接收 `audio_rx` 和发送 `audio_tx`，接口对齐DSP B格式
✅ 添加了数字滤波模块，支持滤波后音频输出

---

# 🎧 Spartan-6 + WM8731 音频开发项目

## 1️⃣ 项目概述

本项目基于 **Spartan-6 FPGA** 和 **WM8731 音频编解码器**，实现了：

✔ 音频数据采集（接收）
✔ 音频数据回放（发送）
✔ 数字滤波功能（低通/高通滤波）
✔ 配置 WM8731 工作在 **从模式 Slave**，数据接口为 **DSP Mode B** 格式
✔ 音频输入输出接口：3.5mm 耳机孔，兼容线路输入输出

本项目适用于音频信号处理、数字滤波实验、基础音频算法测试等场景。

---

## 2️⃣ 硬件平台

| 模块   | 说明                     |
| ---- | ---------------------- |
| FPGA | Spartan-6A309（黑金开发板）   |
| 音频芯片 | WM8731（I2S/DSP 音频编解码器） |
| 音频接口 | 3.5mm 耳机/麦克风接口         |
| 按键   | 切换滤波器模式（低通、高通）      |

---

## 3️⃣ 系统架构

```
          +---------------------------+
          |      按键控制模块         |
          +---------------------------+
                        |
                        v
          +---------------------------+
          |    滤波器模块 (可切换)     |
          +---------------------------+
                        |
          +---------------------------+       +---------------------------+
音频输入 --> |      audio_rx模块        | ----> |      audio_tx模块        | --> 音频输出
(来自WM8731)  |  接收WM8731音频数据(DSP B) |       |  发送WM8731音频数据(DSP B) |
              +---------------------------+       +---------------------------+
```

---

## 4️⃣ WM8731 配置

✅ 模式：**从模式（Slave）**，WM8731不产生时钟，仅接收外部提供的 BCLK 和 LRCLK
✅ 数据格式：**DSP Mode B**（延迟一个 BCLK 边沿，MSB First）
✅ I2C 配置：

| 寄存器   | 配置值（示例）   | 说明             |
| ----- | --------- | -------------- |
| 音频格式  | 0001 1xxx | DSP Mode，Slave |
| 采样率设置 | 48kHz     |                |
| 激活控制  | Enable    | 启用WM8731       |

💡 WM8731 配置请参考芯片手册，需提前通过 I2C 配置寄存器。

---

## 5️⃣ 模块说明

### `audio_rx.v`

* 作用：接收 WM8731 传入的音频数据
* 特点：兼容 **DSP Mode B 格式**，支持左/右声道数据分离

### `audio_tx.v`

* 作用：将滤波后的音频数据发送至 WM8731
* 特点：DSP Mode B 格式输出，数据对齐协议要求

### `lf.v` `hf.v`

* 作用：数字滤波器
* 支持滤波类型：

  * 低通滤波
  * 高通滤波
  * 带通滤波
* 切换方式：按键切换滤波模式，LED指示当前状态

---

## 6️⃣ 主要功能

✅ 实时音频采集与播放
✅ 三种滤波效果自由切换
✅ 完整符合 WM8731 从模式 + DSP Mode B 接口规范
✅ 模块化设计，方便拓展其他音频算法

---

## 7️⃣ 使用说明

1. **硬件连接**

   * 确保 WM8731 正确连接 FPGA 板卡
   * BCLK、LRCLK、数据线（DIN、DOUT）连接无误

2. **编译下载**

   * 使用 ISE 14.7 编译工程
   * 下载 `.bit` 文件至 FPGA 开发板

3. **音频输入输出**

   * 线路输入接口连接音频信号源（手机、播放器等）
   * 输出接口连接耳机或音箱，听取滤波效果

4. **滤波切换**

   * 按下切换按键，滤波模式轮询切换
   * 不同LED灯显示对应滤波模式

---

## 8️⃣  联系方式

如有技术交流或改进建议，欢迎联系开发者。

---


